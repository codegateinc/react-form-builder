{"version":3,"file":"react-form-builder.cjs.development.js","sources":["../src/components/Input.tsx","../src/components/Checkbox.tsx","../src/components/Picker.tsx","../src/types/Form.ts","../src/stores/formStore/formStore.ts","../src/stores/configStore/configStore.ts","../src/stores/index.ts","../src/hooks/useValidate.ts","../src/hooks/useBlur.ts","../src/hooks/useChange.ts","../src/hooks/useEvents.ts","../src/utils/stateUtils.ts","../src/utils/renderHelpers.tsx","../src/hooks/useForm.ts","../src/Form.tsx","../src/FormProvider.tsx"],"sourcesContent":["import React from 'react'\nimport { InputProps } from '../types'\n\n// @ts-ignore\nexport const Input: React.FunctionComponent<InputProps> = ({ component }) => component()\n","import React from 'react'\nimport { CheckBoxProps } from '../types'\n\n// @ts-ignore\nexport const CheckBox: React.FunctionComponent<CheckBoxProps> = ({ component }) => component()\n","import React from 'react'\nimport { PickerProps } from '../types'\n\n// @ts-ignore\nexport const Picker: React.FunctionComponent<PickerProps> = ({ component }) => component()\n","import { FormState } from './FormState'\nimport { KeyValuePair } from './common'\n\nexport enum FormFieldType {\n    Input = 0,\n    Picker = 1,\n    CheckBox = 2\n}\n\ntype ValidationValue = string | number | boolean | Array<FormOption>\n\nexport type FormValidationRule = {\n    errorMessage: string,\n    validationFunction(value: ValidationValue, form: FormState): boolean\n}\n\nexport type FormOptionValue = number | string\n\nexport type FormOption = {\n    value: FormOptionValue,\n    label: string,\n    isSelected?: boolean\n}\n\nexport type FieldConfig = {\n    value?: string | number | boolean,\n    type: FormFieldType,\n    isRequired?: boolean,\n    validationRules?: Array<FormValidationRule>,\n    options?: Array<FormOption>,\n    disabled?: boolean,\n    liveParser?(value: ValidationValue): ValidationValue,\n    forceLiveValidate?: boolean\n}\n\nexport type FormConfig = KeyValuePair<FieldConfig>\n// tslint:disable-next-line:no-any\nexport type OnSuccess = (form: any) => void\nexport type OnError = (errors: Array<KeyValuePair>) => void\nexport type FormProps = {\n    formName: string\n}\nexport type OnUpdate = (form: any) => void\n\nexport interface UseFormProps extends FormProps {\n    formConfig: FormConfig,\n    onSuccess?: OnSuccess,\n    onError?: OnError,\n    onUpdate?: OnUpdate\n}\n","import { useEffect, useState } from 'react'\nimport { G } from '@codegateinc/g-utils'\nimport { FieldConfig, FormFieldType, FormOption, FormPickerState, FormState, SubscribeOnChange } from '../../types'\n\nexport type FormStoreState = {\n    [key: string]: FormState\n}\n\ntype OnChange = {\n    [key: string]: SubscribeOnChange\n}\n\ntype FormStoreOnChange = {\n    [key: string]: OnChange\n}\n\nexport const formStore = () => {\n    const [ formState, setFormState ] = useState<FormStoreState>({})\n    const [ onChangeForm, setOnChangeForm ] = useState<FormStoreOnChange>({})\n\n    return {\n        actions: {\n            setFormState: (key: string, state: FormState) => setFormState(prevState => ({\n                ...prevState,\n                [key]: state\n            })),\n            setFormValue: (formKey: string, key: string, value: string | boolean, callback?: (state: FormState) => void) => {\n                if (!formState[formKey]) {\n                    return\n                }\n\n                const newState = {\n                    ...formState,\n                    [formKey]: {\n                        ...formState[formKey],\n                        [key]: {\n                            ...formState[formKey][key],\n                            value\n                        }\n                    }\n                }\n\n                setFormState(prevState => ({\n                    ...prevState,\n                    [formKey]: {\n                        ...prevState[formKey],\n                        [key]: {\n                            ...prevState[formKey][key],\n                            value\n                        }\n                    }\n                }))\n\n                G.ifDefined(callback, fn => fn(newState[formKey]))\n\n                if (onChangeForm[formKey] && onChangeForm[formKey][key]) {\n                    onChangeForm[formKey][key](value)\n                }\n            },\n            setFormError: (formKey: string, key: string, errorMessage?: string) => formState[formKey] && setFormState(prevState => ({\n                ...prevState,\n                [formKey]: {\n                    ...prevState[formKey],\n                    [key]: {\n                        ...prevState[formKey][key],\n                        errorMessage\n                    }\n                }\n            })),\n            setFormPristine: (formKey: string, key: string, isPristine: boolean) => formState[formKey] && setFormState(prevState => ({\n                ...prevState,\n                [formKey]: {\n                    ...prevState[formKey],\n                    [key]: {\n                        ...prevState[formKey][key],\n                        isPristine\n                    }\n                }\n            })),\n            setFormOptions: (\n                formKey: string,\n                key: string,\n                newOptions: Array<FormOption>,\n                callback?: (state: FormState) => void\n            ) => {\n                if (!formState[formKey]) {\n                    return\n                }\n\n                const newState = () => {\n                    const options = newOptions\n                        .map(option => option.value)\n                    const changedOptions = (formState[formKey][key] as FormPickerState).options\n                        .map(option => ({\n                            ...option,\n                            isSelected: options.includes(option.value)\n                        }))\n\n                    return {\n                        ...formState,\n                        [formKey]: {\n                            ...formState[formKey],\n                            [key]: {\n                                ...formState[formKey][key],\n                                options: changedOptions\n                            }\n                        }\n                    }\n                }\n\n                setFormState(prevState => {\n                    const options = newOptions\n                        .map(option => option.value)\n                    const changedOptions = (prevState[formKey][key] as FormPickerState).options\n                        .map(option => ({\n                            ...option,\n                            isSelected: options.includes(option.value)\n                        }))\n\n                    if (onChangeForm[formKey] && onChangeForm[formKey][key]) {\n                        onChangeForm[formKey][key](changedOptions)\n                    }\n\n                    return {\n                        ...prevState,\n                        [formKey]: {\n                            ...prevState[formKey],\n                            [key]: {\n                                ...prevState[formKey][key],\n                                options: changedOptions\n                            }\n                        }\n                    }\n                })\n                G.ifDefined(callback, fn => fn(newState()[formKey]))\n            },\n            setFormField: (formKey: string, key: string, field: Omit<FieldConfig, 'type'>) => {\n                if (formState[formKey] && formState[formKey][key]) {\n                    setFormState(prevState => ({\n                        ...prevState,\n                        [formKey]: {\n                            ...prevState[formKey],\n                            [key]: {\n                                ...formState[formKey][key],\n                                ...field,\n                                type: formState[formKey][key].type,\n                                options: field.options || (formState[formKey][key].type === FormFieldType.Picker\n                                    ? (formState[formKey][key] as FormPickerState).options\n                                    : []\n                                )\n                            }\n                        }\n                    }))\n                }\n            },\n            getFormField: (formKey: string, key: string) => {\n                if (formState[formKey] && formState[formKey][key]) {\n                    return formState[formKey][key]\n                }\n\n                return {}\n            },\n            onFormFieldChange: (formKey: string, formFieldName: string, onChange: SubscribeOnChange) => {\n                useEffect(() => {\n                    setOnChangeForm(prevState => ({\n                        ...prevState,\n                        [formKey]: {\n                            ...prevState[formKey],\n                            [formFieldName]: onChange\n                        }\n                    }))\n                }, [formState])\n            },\n            clearFormStore: (formKey: string) => {\n                setFormState(prevState => ({\n                    ...prevState,\n                    [formKey]: {}\n                }))\n                setOnChangeForm(prevState => ({\n                    ...prevState,\n                    [formKey]: {}\n                }))\n            }\n        },\n        state: {\n            formState\n        }\n    }\n}\n","import { useState } from 'react'\nimport { FormConfig, OnUpdate, FieldConfig, FormFieldType } from '../../types'\n\nexport type ConfigStoreState = {\n    [key: string]: FormConfig\n}\n\nexport type ConfigOnUpdate = {\n    [key: string]: OnUpdate\n}\n\nexport const configStore = () => {\n    const [ configStore, setConfig ] = useState<ConfigStoreState>({})\n    const [ configOnUpdate, setConfigOnUpdate ] = useState<ConfigOnUpdate>({})\n\n    return {\n        actions: {\n            setConfig: (key: string, newConfig: FormConfig) => setConfig(prevState => ({\n                ...prevState,\n                [key]: newConfig\n            })),\n            clearConfigStore: (formKey: string) => setConfig(prevState => ({\n                ...prevState,\n                [formKey]: {}\n            })),\n            setOnUpdate: (key: string, onUpdate?: OnUpdate) => onUpdate && setConfigOnUpdate(prevState => ({\n                ...prevState,\n                [key]: onUpdate\n            })),\n            setConfigFormField: (formKey: string, key: string, field: Omit<FieldConfig, 'type'>) => {\n                if (configStore[formKey] && configStore[formKey][key]) {\n                    setConfig(prevState => ({\n                        ...prevState,\n                        [formKey]: {\n                            ...prevState[formKey],\n                            [key]: {\n                                ...configStore[formKey][key],\n                                ...field,\n                                type: configStore[formKey][key].type,\n                                options: field.options || (configStore[formKey][key].type === FormFieldType.Picker\n                                    ? configStore[formKey][key].options\n                                    : []\n                                )\n                            }\n                        }\n                    }))\n                }\n            }\n        },\n        state: {\n            configStore,\n            configOnUpdate\n        }\n    }\n}\n","import { formStore } from './formStore'\nimport { configStore } from './configStore'\n\nexport const formBuilderStores = [\n    configStore,\n    formStore\n]\n\nexport {\n    configStore,\n    formStore\n}\n","import { useStore } from 'outstated'\nimport { G } from '@codegateinc/g-utils'\nimport { configStore, formStore } from '../stores'\nimport { FieldState, FormCheckBoxState, FormFieldType, FormInputState, FormOption, FormPickerState } from '../types'\n\nexport const useValidate = () => {\n    const form = useStore(formStore)\n    const config = useStore(configStore)\n\n    return {\n        validateField: (formName: string, key: string, value: string) => {\n            const field = config.state.configStore &&\n                config.state.configStore[formName] &&\n                config.state.configStore[formName][key]\n\n            if (field?.validationRules) {\n                const validated = field.validationRules\n                    .map(rule => rule.validationFunction(value, form.state.formState[formName])\n                        ? rule.errorMessage\n                        : undefined\n                    )\n                const [ errorMessage ] = validated\n                    .filter(value => value)\n\n                form.actions.setFormError(formName, key, errorMessage)\n            }\n        },\n        validateCheckBox: (formName: string, key: string, value: boolean) => {\n            const field = config.state.configStore &&\n                config.state.configStore[formName] &&\n                config.state.configStore[formName][key]\n\n            if (field?.validationRules) {\n                const [ rule ] = field.validationRules\n                const errorMessage = rule.validationFunction(value, form.state.formState[formName])\n                    ? rule.errorMessage\n                    : undefined\n\n                form.actions.setFormError(formName, key, errorMessage)\n            }\n        },\n        validatePicker: (formName: string, key: string, options: Array<FormOption>) => {\n            const field = config.state.configStore &&\n                config.state.configStore[formName] &&\n                config.state.configStore[formName][key]\n            const validated = field?.validationRules && field.validationRules\n                .map(rule => rule.validationFunction(options, form.state.formState[formName])\n                    ? rule.errorMessage\n                    : undefined\n                )\n            const [ errorMessage ] = validated || [undefined]\n                .filter(value => value)\n            const isAnyOptionSelected = field?.options && field.options\n                .some(option => option.isSelected)\n\n            if (field?.isRequired && isAnyOptionSelected) {\n                return form.actions.setFormError(formName, key, undefined)\n            }\n\n            form.actions.setFormError(formName, key, errorMessage)\n        },\n        validateForm: (formName: string, shouldUpdateStore: boolean = true) => form.state.formState[formName] ? G.toPairs<FieldState>(form.state.formState[formName])\n            .map(([key, formState]) => {\n                const configField = config.state.configStore && config.state.configStore[formName][key]\n\n                if (configField?.validationRules && formState.type === FormFieldType.Input) {\n                    const value = (formState as FormInputState).value\n\n                    if (!formState.isRequired && value === '') {\n                        return undefined\n                    }\n\n                    const validated = configField.validationRules\n                        .map(rule => rule.validationFunction(value, form.state.formState[formName])\n                            ? rule.errorMessage\n                            : undefined\n                        )\n                    const [ errorMessage ] = validated\n                        .filter(value => value)\n\n                    if (shouldUpdateStore) {\n                        form.actions.setFormError(formName, key, errorMessage)\n                    }\n\n                    return errorMessage\n                }\n\n                if (configField?.validationRules && formState.type === FormFieldType.CheckBox) {\n                    const value = (formState as FormCheckBoxState).value\n\n                    if (!formState.isRequired) {\n                        return undefined\n                    }\n\n                    const [ rule ] = configField.validationRules\n                    const errorMessage = rule.validationFunction(value, form.state.formState[formName])\n                        ? rule.errorMessage\n                        : undefined\n\n                    if (shouldUpdateStore) {\n                        form.actions.setFormError(formName, key, errorMessage)\n                    }\n\n                    return errorMessage\n                }\n\n                if (configField?.validationRules && formState.type === FormFieldType.Picker) {\n                    const options = (formState as FormPickerState).options\n\n                    if (!formState.isRequired) {\n                        return undefined\n                    }\n\n                    const validated = configField.validationRules\n                        .map(rule => rule.validationFunction(options, form.state.formState[formName])\n                            ? rule.errorMessage\n                            : undefined\n                        )\n                    const [ errorMessage ] = validated\n                        .filter(value => value)\n\n                    if (shouldUpdateStore) {\n                        form.actions.setFormError(formName, key, errorMessage)\n                    }\n\n                    return errorMessage\n                }\n            }) : []\n    }\n}\n","import { useStore } from 'outstated'\nimport { useValidate } from './useValidate'\nimport { configStore, formStore } from '../stores'\n\nexport const useBlur = () => {\n    const form = useStore(formStore)\n    const config = useStore(configStore)\n    const { validateField } = useValidate()\n\n    return {\n        onInputBlur: (formName: string, key: string, value: string) => {\n            const field = form.state.formState[formName][key]\n            const configField = config.state.configStore && config.state.configStore[formName][key]\n\n            if (field.isRequired || value !== configField?.value) {\n                form.actions.setFormPristine(formName, key, false)\n            }\n\n            validateField(formName, key, value)\n        }\n    }\n}\n","import { useStore } from 'outstated'\nimport { G } from '@codegateinc/g-utils'\nimport { useValidate } from './useValidate'\nimport { configStore, formStore } from '../stores'\nimport { FormCheckBoxState, FormInputState, FormOption, FormState } from '../types'\n\nexport const useChange = () => {\n    const { state, actions } = useStore(formStore)\n    const form = useStore(configStore)\n    const { validateField, validateCheckBox, validatePicker } = useValidate()\n\n    return {\n        onInputChange: (formName: string, key: string, value: string, callback?: (state: FormState) => void) => {\n            const field = state.formState[formName][key] as FormInputState\n            const configField = form.state.configStore &&\n                form.state.configStore[formName] &&\n                form.state.configStore[formName][key]\n\n            const parsedValue = configField?.liveParser\n                ? configField.liveParser(value)\n                : value\n\n            if (typeof parsedValue !== 'string') {\n                throw new Error('liveParser must return string on input')\n            }\n\n            const shouldValidateField = field.errorMessage || !field.isPristine || configField.forceLiveValidate\n\n            if (shouldValidateField) {\n                validateField(formName, key, parsedValue)\n            }\n\n            actions.setFormValue(formName, key, parsedValue, callback)\n        },\n        onCheckboxChange: (formName: string, key: string, callback?: (state: FormState) => void) => {\n            const field = state.formState[formName][key] as FormCheckBoxState\n            const configField = form.state.configStore &&\n                form.state.configStore[formName] &&\n                form.state.configStore[formName][key]\n\n            const parsedValue = configField?.liveParser\n                ? configField.liveParser(!field.value)\n                : !field.value\n\n            if (typeof parsedValue !== 'boolean') {\n                throw new Error('liveParser must return boolean on checkbox')\n            }\n\n            if ((field.isRequired && !field.isPristine) || field.errorMessage || configField.validationRules) {\n                validateCheckBox(formName, key, parsedValue)\n            }\n\n            actions.setFormValue(formName, key, parsedValue, callback)\n        },\n        onPickerChange: (formName: string, key: string, options: Array<FormOption>, callback?: (state: FormState) => void) => {\n            const configField = form.state.configStore &&\n                form.state.configStore[formName] &&\n                form.state.configStore[formName][key]\n            const valuedOptions = options.map(item => item.value)\n            const fullOptions = configField?.options?.map(option => ({\n                ...option,\n                isSelected: valuedOptions.includes(option.value)\n            }))\n\n            const parsedOptions = configField?.liveParser\n                ? configField.liveParser(options)\n                : options\n\n            if (!G.is(Array, parsedOptions)) {\n                throw new Error('liveParser must return array on picker')\n            }\n\n            validatePicker(formName, key, fullOptions || [])\n            actions.setFormOptions(formName, key, parsedOptions as Array<FormOption>, callback)\n        }\n    }\n}\n","import { useBlur } from './useBlur'\nimport { useChange } from './useChange'\n\nexport const useEvents = () => {\n    const { onInputBlur } = useBlur()\n    const { onInputChange, onCheckboxChange, onPickerChange } = useChange()\n\n    return {\n        input: {\n            onBlur: onInputBlur,\n            onChange: onInputChange\n        },\n        checkBox: {\n            onChange: onCheckboxChange\n        },\n        picker: {\n            onChange: onPickerChange\n        }\n    }\n}\n","import { G } from '@codegateinc/g-utils'\nimport {\n    FieldConfig,\n    FieldState,\n    FormCheckBoxState,\n    FormConfig,\n    FormFieldType,\n    FormInputState,\n    FormPickerState,\n    FormState\n} from 'types'\n\nexport const prepareFormInitialState = (formConfig: FormConfig, clearForm: boolean = false) => {\n    const configToPairs = G.toPairs<FieldConfig>(formConfig)\n        .map(([ fieldName, config ]) => {\n            if (config?.isRequired && !config?.validationRules) {\n                throw new Error('validationRules are required if field isRequired  ')\n            }\n\n            if (config.type === FormFieldType.Input) {\n                return [fieldName, {\n                    value: clearForm\n                        ? ''\n                        : config.value || '',\n                    isRequired: config?.isRequired || false,\n                    isPristine: true,\n                    disabled: config?.disabled || false,\n                    type: config.type,\n                    errorMessage: undefined\n                }]\n            }\n\n            if (config.type === FormFieldType.CheckBox) {\n                return [fieldName, {\n                    value: clearForm\n                        ? false\n                        : config.value || false,\n                    isRequired: config?.isRequired || false,\n                    isPristine: true,\n                    disabled: config?.disabled || false,\n                    type: config.type,\n                    errorMessage: undefined\n                }]\n            }\n\n            if (config.type === FormFieldType.Picker) {\n                return [fieldName, {\n                    isRequired: config?.isRequired || false,\n                    isPristine: true,\n                    disabled: config?.disabled || false,\n                    type: config.type,\n                    errorMessage: undefined,\n                    options: clearForm\n                        ? config.options?.map(option => ({\n                            ...option,\n                            isSelected: false\n                        })) || []\n                        : config.options || []\n                }]\n            }\n        }) as Array<[string, FieldState]>\n\n    return G.fromPairs(configToPairs)\n}\n\nexport const parseForm = (state: FormState) => state && G.toPairs<FieldState>(state)\n    .reduce((acc, [key, object]) => {\n        if (object.type === FormFieldType.Input || object.type === FormFieldType.CheckBox) {\n            const value = (object as FormInputState | FormCheckBoxState).value\n\n            return {\n                ...acc,\n                [key]: value\n            }\n        }\n\n        if (object.type === FormFieldType.Picker) {\n            const options = (object as FormPickerState).options\n                .filter(option => option.isSelected)\n                .map(option => option.value)\n\n            return {\n                ...acc,\n                [key]: options\n            }\n        }\n\n        return acc\n    }, {})\n","import React from 'react'\nimport { G } from '@codegateinc/g-utils'\nimport { useStore } from 'outstated'\nimport { useEvents } from 'hooks/useEvents'\nimport { configStore, formStore } from 'stores'\nimport {\n    FormOption,\n    InputProps,\n    PickerProps,\n    CheckBoxProps,\n    FormFieldType,\n    FormInputState,\n    FormPickerState,\n    FormCheckBoxState\n} from '../types'\nimport { parseForm } from './stateUtils'\nimport { FieldConfig } from 'types/Form'\n\nexport const renderForm = (\n    children: React.ReactNode,\n    formName: string\n) => {\n    if (!children) {\n        throw new Error('children are mandatory')\n    }\n\n    return React.Children.map(children, child => renderChild(child, formName))\n}\n\nconst renderChild = (child: React.ReactNode, formName: string) => {\n    if (typeof child === 'string' || typeof child === 'number' || typeof child === null) {\n        return child\n    }\n\n    const { state } = useStore(formStore)\n    const { state: { configOnUpdate, configStore: config } } = useStore(configStore)\n\n    // tslint:disable-next-line:no-any\n    const reactElementChild = child as React.ReactElement<any>\n    const form = config[formName]\n    const elType = form\n        ? (form[reactElementChild.props.formFieldName] as FieldConfig)?.type\n        : undefined\n\n    if (elType === FormFieldType.Input) {\n        const { input } = useEvents()\n        const inputChild = child as React.ReactElement<InputProps>\n        const key = inputChild.props.formFieldName\n        const formState = state.formState[formName]\n        const inputState = formState ? formState[key] as FormInputState : undefined\n\n        return React.cloneElement<InputProps>(inputChild, {\n            ...inputChild.props,\n            component: () => inputChild.props.component({\n                value: inputState?.value || '',\n                onChangeText: text => input.onChange(formName, key, text, state => {\n                    G.ifDefined(configOnUpdate[formName], fn => fn(parseForm(state)))\n                }),\n                onBlur: () => input.onBlur(formName, key, inputState?.value || ''),\n                errorMessage: inputState?.errorMessage,\n                disabled: inputState?.disabled || false,\n                isPristine: inputState?.isPristine || true\n            })\n        })\n    }\n\n    if (elType === FormFieldType.CheckBox) {\n        const { checkBox } = useEvents()\n        const checkBoxChild = child as React.ReactElement<CheckBoxProps>\n        const key = checkBoxChild.props.formFieldName\n        const formState = state.formState[formName]\n        const checkBoxState = formState ? formState[key] as FormCheckBoxState : undefined\n\n        return React.cloneElement<CheckBoxProps>(checkBoxChild, {\n            ...checkBoxChild.props,\n            component: () => checkBoxChild.props.component({\n                value: checkBoxState?.value || false,\n                onChange: () => checkBox.onChange(formName, key, state => {\n                    G.ifDefined(configOnUpdate[formName], fn => fn(parseForm(state)))\n                }),\n                errorMessage: checkBoxState?.errorMessage,\n                disabled: checkBoxState?.disabled || false,\n                isPristine: checkBoxState?.isPristine || true\n            })\n        })\n    }\n\n    if (elType === FormFieldType.Picker) {\n        const { picker } = useEvents()\n        const pickerChild = child as React.ReactElement<PickerProps>\n        const key = pickerChild.props.formFieldName\n        const formState = state.formState[formName]\n        const pickerState = formState ? formState[key] as FormPickerState : undefined\n\n        return React.cloneElement<PickerProps>(pickerChild, {\n            ...pickerChild.props,\n            component: () => pickerChild.props.component({\n                onChange: (options: Array<FormOption>) => picker.onChange(formName, key, options, state => {\n                    G.ifDefined(configOnUpdate[formName], fn => fn(parseForm(state)))\n                }),\n                errorMessage: pickerState?.errorMessage,\n                disabled: pickerState?.disabled || false,\n                isPristine: pickerState?.isPristine || true,\n                options: pickerState?.options || []\n            })\n        })\n    }\n\n    const reactElementChildren = reactElementChild.props.children\n\n    if (reactElementChildren) {\n        const newChildren = React.Children.map(reactElementChildren, child => renderChild(child, formName))\n\n        return React.cloneElement(reactElementChild, reactElementChild.props, newChildren)\n    }\n\n    return reactElementChild\n}\n","import { useEffect } from 'react'\nimport { useStore } from 'outstated'\nimport { G } from '@codegateinc/g-utils'\nimport { parseForm, prepareFormInitialState } from 'utils'\nimport { configStore, formStore } from 'stores'\nimport {\n    FieldState,\n    FieldConfig,\n    UseFormProps,\n    SubscribeOnChange\n} from 'types'\nimport { useValidate } from './useValidate'\n\nexport const useForm = <T>({\n    formName,\n    formConfig,\n    onError,\n    onSuccess,\n    onUpdate\n}: UseFormProps) => {\n    const { state, actions } = useStore(formStore)\n    const config = useStore(configStore)\n    const { validateForm } = useValidate()\n\n    useEffect(() => {\n        const formState = prepareFormInitialState(formConfig)\n\n        config.actions.setConfig(formName, formConfig)\n        config.actions.setOnUpdate(formName, onUpdate)\n        actions.setFormState(formName, formState)\n\n        return () => {\n            config.actions.clearConfigStore(formName)\n            actions.clearFormStore(formName)\n        }\n    }, [])\n\n    return {\n        submitForm: () => {\n            const validated = validateForm(formName)\n\n            const hasAnyError = validated\n                .some(value => value)\n\n            if (hasAnyError) {\n                return G.ifDefined(onError, fn => fn(validated))\n            }\n\n            const parsedForm = parseForm(state.formState[formName])\n\n            return G.ifDefined(onSuccess, fn => fn(parsedForm))\n        },\n        hasChanges: state.formState[formName] && G.toPairs<FieldState>(state.formState[formName])\n            .some(([key, object]) => !object.isPristine),\n        setField: (formFieldName: string, field: Omit<FieldConfig, 'type'>) => {\n            actions.setFormField(formName, formFieldName, field)\n            config.actions.setConfigFormField(formName, formFieldName, field)\n        },\n        isFormValid: !validateForm(formName, false)\n            .some(error => error),\n        getField: (formFieldName: string) => actions.getFormField(formName, formFieldName),\n        subscribe: (formFieldName: string) => ({\n            onChange: <T>(onChange: SubscribeOnChange<T>) => actions.onFormFieldChange(formName, formFieldName, onChange)\n        }),\n        restoreToInitial: () => {\n            if (config.state.configStore) {\n                const newState = prepareFormInitialState(config.state.configStore[formName])\n\n                actions.setFormState(formName, newState)\n\n                G.ifDefined(onUpdate, fn => fn(parseForm(newState)))\n            }\n        },\n        clearForm: () => {\n            if (config.state.configStore) {\n                const newState = prepareFormInitialState(config.state.configStore[formName], true)\n\n                actions.setFormState(formName, newState)\n\n                G.ifDefined(onUpdate, fn => fn(parseForm(newState)))\n            }\n        },\n        setFieldError: (formFieldName: string, errorMessage: string) => actions.setFormError(formName, formFieldName, errorMessage),\n        isFormReady: G.hasKeys(state.formState[formName])\n    }\n}\n","import React, { Fragment } from 'react'\nimport { renderForm } from 'utils'\nimport { FormProps } from './types'\n\nexport const Form: React.FunctionComponent<FormProps> = ({\n    children,\n    formName\n}) => (\n    <Fragment>\n        {renderForm(children, formName)}\n    </Fragment>\n)\n","import React from 'react'\nimport { Provider } from 'outstated'\nimport { formBuilderStores } from './stores'\n\nexport const FormProvider: React.FunctionComponent = ({ children }) => (\n    <Provider stores={formBuilderStores}>\n        {children}\n    </Provider>\n)\n"],"names":["Input","component","CheckBox","Picker","FormFieldType","formStore","useState","formState","setFormState","onChangeForm","setOnChangeForm","actions","key","state","prevState","setFormValue","formKey","value","callback","newState","G","ifDefined","fn","setFormError","errorMessage","setFormPristine","isPristine","setFormOptions","newOptions","options","map","option","changedOptions","isSelected","includes","setFormField","field","type","getFormField","onFormFieldChange","formFieldName","onChange","useEffect","clearFormStore","configStore","setConfig","configOnUpdate","setConfigOnUpdate","newConfig","clearConfigStore","setOnUpdate","onUpdate","setConfigFormField","formBuilderStores","useValidate","form","useStore","config","validateField","formName","validationRules","validated","rule","validationFunction","undefined","filter","validateCheckBox","validatePicker","isAnyOptionSelected","some","isRequired","validateForm","shouldUpdateStore","toPairs","configField","useBlur","onInputBlur","useChange","onInputChange","parsedValue","liveParser","Error","shouldValidateField","forceLiveValidate","onCheckboxChange","onPickerChange","valuedOptions","item","fullOptions","parsedOptions","is","Array","useEvents","input","onBlur","checkBox","picker","prepareFormInitialState","formConfig","clearForm","configToPairs","fieldName","disabled","fromPairs","parseForm","reduce","acc","object","renderForm","children","React","Children","child","renderChild","reactElementChild","elType","props","inputChild","inputState","cloneElement","onChangeText","text","checkBoxChild","checkBoxState","pickerChild","pickerState","reactElementChildren","newChildren","useForm","onError","onSuccess","submitForm","hasAnyError","parsedForm","hasChanges","setField","isFormValid","error","getField","subscribe","restoreToInitial","setFieldError","isFormReady","hasKeys","Form","Fragment","FormProvider","Provider","stores"],"mappings":"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"}